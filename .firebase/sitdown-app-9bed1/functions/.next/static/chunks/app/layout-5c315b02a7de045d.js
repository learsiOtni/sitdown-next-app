(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7204:function(e,t,a){Promise.resolve().then(a.bind(a,1274))},1274:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return G}});var r=a(7437),s=a(5651),n=a.n(s);a(2471);var d=a(2265),i=a(7713),l=(a(1195),a(8875)),u=a(4033),o=a(1396),c=a.n(o),p=a(8862),f=a(2731),h=a(3043),g=[{id:1,title:"dashboard",url:"/dashboard"},{id:2,title:"updates",url:"/updates"},{id:3,title:"projects",url:"/projects"},{id:4,title:"tags",url:"/tags"},{id:5,title:"users",url:"/users"}],m=a(6691),x=a.n(m),A=a(6605),y=a(279),b=e=>{let{width:t,height:a,smallLogo:s}=e,n=A.default;return s&&(n=y.default),(0,r.jsx)(x(),{src:n,width:t,height:a,alt:"Sitdown app logo"})},w=a(2507),j=()=>{let e=(0,u.usePathname)(),t=(0,u.useRouter)(),a=(0,p.TL)(),s=(0,p.CG)(e=>e.updates.status),n=(0,p.CG)(e=>e.auth.credentials.user);return(0,r.jsxs)("header",{className:"w-28 h-screen flex flex-col items-center fixed",children:[(0,r.jsx)("div",{className:"mt-11",children:(0,r.jsx)(b,{width:29,height:50,smallLogo:!0})}),(0,r.jsx)("div",{className:"h-7 mt-20 cursor-pointer hover:text-lg hover:opacity-90",children:(0,r.jsx)(l.Z,{name:"add",background:!0,size:"2xl",onClick:()=>{"failed"!==s&&"idle"!==s&&a((0,h.Tf)("idle")),a((0,h.b9)()),a((0,h.$J)())}})}),(0,r.jsx)("nav",{className:"w-5 mt-8",children:(0,r.jsx)("ul",{children:g.map(t=>(0,r.jsx)("li",{className:"pt-7 transition \n                                ".concat(e===t.url?"text-primary":"text-[#B6B6B6]","\n                                hover:text-primary hover:text-opacity-80"),children:(0,r.jsx)(c(),{href:t.url,children:(0,r.jsx)(l.Z,{name:t.title})})},t.id))})}),(0,r.jsxs)("div",{className:"w-9 h-9 mt-[190px] background-red relative",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full bg-brand z-10 absolute left-6 top-[-5px]"}),(0,r.jsx)(c(),{href:"/profile",children:(0,r.jsx)("div",{className:"w-full h-full rounded-full border relative ".concat("/profile"===e&&"border-brand"," hover:opacity-70 hover:border-brand"),children:(0,r.jsx)(w.Z,{image:n.image})})})]}),(0,r.jsx)("button",{className:"hover:opacity-50",onClick:()=>{a((0,f.kS)()),t.push("/login")},children:"Logout"})]})},v=a(7507),C=a(8957),k=a(1361),T=a(2171),N={title:{label:"Headline*",elementType:"input",config:{id:"title",type:"text",name:"title"},value:"",validation:{isRequired:!0},valid:!0},body:{label:"Description*",elementType:"editor",config:{id:"body",type:"text",name:"body"},value:"",validation:{},valid:!0},projectId:{label:"Assign to a project",elementType:"projectMenu",config:{id:"projectId",type:"text",name:"projectId"},value:"",validation:{},valid:!0},tags:{elementType:"input",label:"Tags*",subLabel:"(Separate tags using space)",config:{id:"tags",type:"text",name:"tags"},value:"",validation:{},valid:!0}};function E(){let e=(0,i.getCookie)("authToken"),t=(0,u.useRouter)(),a=(0,p.TL)(),s=(0,p.CG)(e=>e.updates.errors),n=(0,p.CG)(e=>e.updates.isModalOpen),l=(0,p.CG)(e=>e.updates.status),o=(0,p.CG)(e=>e.auth.credentials.user);return(0,d.useEffect)(()=>{"postSucceeded"===l&&(a((0,h.Tf)("idle")),a((0,h.$J)()),t.refresh(),t.push("/dashboard"))},[l,a,t]),(0,r.jsx)(T.Z,{title:"Add new update",isOpen:n,toggle:()=>a((0,h.$J)()),children:"postSucceeded"!==l&&(0,r.jsx)(k.Z,{formFile:N,className:"flex flex-col min-w-full",onSubmit:t=>{let r=[];"string"==typeof t.tags&&(r=(0,v.ny)(t.tags));let{id:s,firstname:n,lastname:d,image:i}=o,l={body:{...t,tags:r},token:e,userInfo:{id:s,firstname:n,lastname:d,image:i}};a((0,h.ER)(l))},errors:s,children:(0,r.jsx)(C.Z,{type:"submit",className:"text-xl p-10 mb-7 place-self-end",children:"Add"})})})}var D=a(8762),S=e=>{let{children:t}=e,a=(0,p.TL)(),s=(0,p.CG)(e=>e.auth.isAuth),n=(0,p.CG)(e=>e.auth.credentials.user.id),l=(0,p.CG)(e=>e.updates.updates);return(0,d.useEffect)(()=>{let e=(0,i.getCookie)("authToken");e&&a((0,f.nX)(e))},[a]),(0,d.useEffect)(()=>{s&&Object.keys(l).length<=0&&(a((0,D.bl)()),a((0,h.f9)()))},[s,l,a]),(0,r.jsx)("div",{children:s&&n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E,{}),(0,r.jsx)(j,{}),(0,r.jsx)("div",{className:"flex ml-[110px] bg-[#F5F7FA] h-full min-h-screen",children:t}),!1]}):(0,r.jsx)("div",{children:t})})},U=a(1023),R=a(4302),Z=a(8324),L=a(2967);let P=(0,Z.LC)({reducerPath:"authApi",baseQuery:(0,L.ni)({baseUrl:"https://us-central1-sitdown-834fc.cloudfunctions.net/api/",prepareHeaders:(e,t)=>{let{getState:a}=t,r=(0,i.getCookie)("authToken");if(r)return e.set("authorization","Bearer ".concat(r)),e}}),endpoints:e=>({getAuthenticatedUser:e.query({query:()=>({url:"/user",method:"GET"})})})}),{useGetAuthenticatedUserQuery:I}=P,M=()=>(0,R.xC)({reducer:{auth:f.ZP,updates:h.ZP,projects:D.ZP,[P.reducerPath]:P.reducer},middleware:e=>e().concat(P.middleware)});function O(e){let{children:t}=e,a=(0,d.useRef)();return a.current||(a.current=M()),(0,r.jsx)(U.zt,{store:a.current,children:t})}function G(e){let{children:t}=e;return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{className:n().className,children:(0,r.jsx)(O,{children:(0,r.jsx)(S,{children:t})})})})}},1195:function(e,t,a){"use strict";var r=a(7437);t.Z=e=>{let{className:t,children:a}=e,s="border-[#E2E5E6] bg-white rounded shadow-md ";return t&&(s+=t),(0,r.jsx)("div",{className:s,children:a})}},2171:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var r=a(7437),s=a(2265),n=a(1195),d=a(8875);function i(e){let{title:t,isOpen:a,toggle:i,children:l}=e,u=(0,s.useRef)(null);return(0,s.useEffect)(()=>{a?document.body.style.overflow="hidden":document.body.style.overflow="auto";let e=e=>{u&&u.current===e.target&&i()},t=u.current;return null==t||t.addEventListener("click",e),()=>null==t?void 0:t.removeEventListener("click",e)},[a,i]),(0,r.jsx)("div",{className:"".concat(a?"block":"hidden"," w-full h-full fixed top-0 left-0 bg-[rgba(0,0,0,0.5)] z-50 py-10 overflow-hidden"),ref:u,children:(0,r.jsxs)(n.Z,{className:"bg-red-500 w-[600px] my-0 mx-auto",children:[(0,r.jsxs)("header",{className:"py-4 px-5 bg-[#F4F8F9] flex-between",children:[(0,r.jsx)("h3",{className:"text-title",children:t}),(0,r.jsx)("button",{className:"hover:opacity-80",onClick:i,children:(0,r.jsx)(d.Z,{name:"close",iconContainerStyle:"w-5 h-5 bg-body opacity-50 rounded-full text-white cursor-pointer",size:"xs"})})]}),(0,r.jsx)("div",{className:"px-5 pt-5 max-h-[80vh] overflow-scroll",children:l})]})})}},2731:function(e,t,a){"use strict";a.d(t,{W$:function(){return h},b9:function(){return p},kS:function(){return f},nX:function(){return l},x4:function(){return i}});var r=a(4302),s=a(7713),n=a(4332);let d={isAuth:!1,credentials:{token:"",user:{id:"",email:"",firstname:"",lastname:"",createdAt:"",image:""}},status:"idle",errors:{}},i=(0,r.hg)("/login",async(e,t)=>{let{userData:a,isSignup:r}=e,{rejectWithValue:d}=t,i="".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","login");r&&(i="".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","signup"));let l=await n.h.post(i,a);return l.token?((0,s.setCookie)("authToken",l.token,{expires:new Date(Date.now()+36e5)}),l):d(l)}),l=(0,r.hg)("/getAuthUser",async(e,t)=>{let{rejectWithValue:a}=t,r=await n.h.get("".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","user"),void 0,e);return r.error?a(r.error):r}),u=(0,r.oM)({name:"auth",initialState:d,reducers:{setAuth:e=>{e.isAuth=!0},setProfileImage:(e,t)=>{e.credentials.user.image=t.payload},setCredentials:(e,t)=>{e.credentials.user=t.payload,e.isAuth=!0},clearErrors:e=>{e.errors={}},logout:e=>((0,s.deleteCookie)("authToken"),d)},extraReducers(e){e.addCase(i.pending,(e,t)=>{e.errors={},e.status="loading"}).addCase(i.fulfilled,(e,t)=>{e.status="succeeded",e.isAuth=!0,e.credentials.token=t.payload.token}).addCase(i.rejected,(e,t)=>{e.status="failed",e.errors=t.payload}).addCase(l.pending,(e,t)=>{e.errors={},e.status="loading"}).addCase(l.fulfilled,(e,t)=>{e.status="succeeded",e.credentials.user=t.payload,e.isAuth=!0}).addCase(l.rejected,(e,t)=>{e.status="failed",e.errors=t.error.message})}}),{setAuth:o,setCredentials:c,clearErrors:p,logout:f,setProfileImage:h}=u.actions;t.ZP=u.reducer},3043:function(e,t,a){"use strict";a.d(t,{$J:function(){return p},ER:function(){return d},Tf:function(){return o},Vx:function(){return f},b9:function(){return c},dw:function(){return i},ec:function(){return l},f9:function(){return n}});var r=a(4332),s=a(4302);let n=(0,s.hg)("/updates/fetchUpdates",async(e,t)=>{let{rejectWithValue:a}=t,s=await r.h.get("".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","updates"));return s.error?a(s):s}),d=(0,s.hg)("/updates/postUpdate",async(e,t)=>{let{body:a,token:s,userInfo:n}=e,{rejectWithValue:d}=t,i=await r.h.post("".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","updates"),a,s);if(!i.id)return d(i);let{userId:l,...u}=i;return{...u,user:n}}),i=(0,s.hg)("/updates/editUpdate",async(e,t)=>{let{body:a,token:s,userInfo:n,id:d}=e,{rejectWithValue:i}=t,l=await r.h.post("".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","updates/").concat(d),a,s);if(!l.id)return i(l);let{userId:u,...o}=l;return{...o,user:n}}),l=(0,s.hg)("/updates/deleteUpdate",async(e,t)=>{let{id:a,token:s}=e,{rejectWithValue:n}=t,d=await r.h.delete("".concat("https://us-central1-sitdown-834fc.cloudfunctions.net/api/","updates/").concat(a),null,s);return d.error?n(d):{id:a,message:d}}),u=(0,s.oM)({name:"updates",initialState:{updates:[],status:"idle",errors:{},isModalOpen:!1,updateId:""},reducers:{setStatus:(e,t)=>{e.status=t.payload},clearErrors:e=>{e.errors={}},toggleModal:e=>{e.isModalOpen=!e.isModalOpen},setUpdates:(e,t)=>{e.updates=t.payload}},extraReducers(e){e.addCase(n.pending,(e,t)=>{e.status="loading",e.errors={}}).addCase(n.fulfilled,(e,t)=>{e.status="fetchSucceeded",e.updates=e.updates.concat(t.payload)}).addCase(n.rejected,(e,t)=>{e.status="failed",e.errors=t.error.message}).addCase(d.pending,(e,t)=>{e.status="loading",e.errors={}}).addCase(d.fulfilled,(e,t)=>{e.status="postSucceeded",e.updates.unshift(t.payload),e.errors={}}).addCase(d.rejected,(e,t)=>{e.status="failed",e.errors=t.payload}).addCase(i.pending,(e,t)=>{e.status="loading",e.errors={}}).addCase(i.fulfilled,(e,t)=>{let a=e.updates.findIndex(e=>e.id===t.payload.id);e.status="editSucceeded",e.updates[a]=t.payload,e.errors={}}).addCase(i.rejected,(e,t)=>{e.status="failed",e.errors=t.payload}).addCase(l.pending,(e,t)=>{e.status="loading",e.errors={}}).addCase(l.fulfilled,(e,t)=>{let a=e.updates.findIndex(e=>e.id===t.payload.id);e.updates.splice(a,1),e.status="deleteSucceeded",e.errors={}}).addCase(l.rejected,(e,t)=>{e.status="failed",e.errors=t.payload})}}),{setStatus:o,clearErrors:c,toggleModal:p,setUpdates:f}=u.actions;t.ZP=u.reducer},7507:function(e,t,a){"use strict";a.d(t,{Yd:function(){return d},bT:function(){return n},jQ:function(){return l},ny:function(){return i},p6:function(){return r}});let r=e=>{let t,a;let r=2592e6,s=new Date,n=s.getTime()-new Date(e).getTime();n<6e4?(a=1e3,t="seconds"):n<36e5?(a=6e4,t="minutes"):n<864e5?(a=36e5,t="hours"):n<r?(a=864e5,t="days"):n<31536e6?(a=r,t="months"):(a=1e3,t="seconds");let d=Math.round(n/a);return 1===d&&(t=t.slice(0,-1)),"".concat(d," ").concat(t," ago")},s=e=>"0".concat(e),n=e=>{let t=new Date(e),a=t.getUTCHours().toLocaleString(),n=t.getUTCMinutes().toLocaleString(),d=new Date,i=d.getTime()-t.getTime();return i<216e5?r(e):"".concat(1===a.length?s(a):a,":").concat(1===n.length?s(n):n)},d=e=>{let t=new Date,a=t.getTime()-new Date(e).getTime();if(a<864e5)return"Today";if(a>864e5&&a<1728e5)return"Yesterday";let r=e.split(" ");return"".concat(r[0],", ").concat(r[2]," ").concat(r[1])},i=e=>{let t=e.replace(/[^a-zA-Z ]/g," ").replace(/\s+/g," ").split(" "),a=[];return t.forEach(e=>{a.includes(e.toLowerCase())||a.push(e.toLowerCase())}),a},l=e=>e.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())},2471:function(){},6605:function(e,t,a){"use strict";a.r(t),t.default={src:"/_next/static/media/logo.3db8de2a.png",height:85,width:318,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAYAAABllJ3tAAAAQ0lEQVR4nGPkvX3hoOYbqTTJS6LCfzn//2X4x8DEwMDwCYj/AzEzo9OcD/NY/7If4eDmOPH3z38RkCAQ/wRiFiD+DgAeHxU53/1E3AAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:2}},279:function(e,t,a){"use strict";a.r(t),t.default={src:"/_next/static/media/small-logo.68fdcc73.png",height:85,width:58,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAICAYAAAAx8TU7AAAAlUlEQVR42mNgen+viOnD/b9MHx/8Z/p4/wnj18cCDMyPL38H4n8sjy7/Z310ueP///8MDKyXjv5gu3T0P+Plo78Ybu6SAgtyHN2dxHx05xexg/sXgQRAGEJsZ2D1nfT9uN+kH999J/2IAQt6Tf/p7DHj+38ofg0WdFrwdRcQ/4fi+ww2y77o2i778hqI3wPxK9ulX4IANSNmIQMKl4wAAAAASUVORK5CYII=",blurWidth:5,blurHeight:8}}},function(e){e.O(0,[676,572,902,222,336,385,485,41,971,596,744],function(){return e(e.s=7204)}),_N_E=e.O()}]);